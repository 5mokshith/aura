"useclient";

importReact,{useState}from"react";
importtype{WorkflowResult}from"@/types";
import{Button}from"@/components/ui/button";
import{ExternalLink,Mail,Download,Copy,Check}from"lucide-react";

interfaceActionButtonsProps{
result:WorkflowResult;
}

exportfunctionActionButtons({result}:ActionButtonsProps){
const[copied,setCopied]=useState(false);

consthandleCopyToClipboard=async()=>{
try{
consttextToCopy=result.preview||result.url||result.title;
awaitnavigator.clipboard.writeText(textToCopy);
setCopied(true);
setTimeout(()=>setCopied(false),2000);
}catch(err){
console.error("Failedtocopytoclipboard:",err);
}
};

consthandleOpenExternal=()=>{
if(result.url){
window.open(result.url,"_blank","noopener,noreferrer");
}
};

consthandleDownload=()=>{
if(result.url){
//Createatemporaryanchorelementtotriggerdownload
constlink=document.createElement("a");
link.href=result.url;
link.download=result.title;
link.target="_blank";
link.rel="noopenernoreferrer";
document.body.appendChild(link);
link.click();
document.body.removeChild(link);
}
};

return(
<divclassName="flexflex-wrapgap-2"role="group"aria-label="Resultactions">
{/*Type-specificprimaryaction*/}
{result.type==="document"&&result.url&&(
<Button
size="sm"
onClick={handleOpenExternal}
className="flex-1"
aria-label={`Open${result.title}inGoogleDrive`}
>
<ExternalLinkclassName="size-4"aria-hidden="true"/>
OpeninDrive
</Button>
)}

{result.type==="email"&&result.url&&(
<Button
size="sm"
onClick={handleOpenExternal}
className="flex-1"
aria-label={`Viewemail:${result.title}`}
>
<MailclassName="size-4"aria-hidden="true"/>
ViewEmail
</Button>
)}

{result.type==="calendar"&&result.url&&(
<Button
size="sm"
onClick={handleOpenExternal}
className="flex-1"
aria-label={`Opencalendarevent:${result.title}`}
>
<ExternalLinkclassName="size-4"aria-hidden="true"/>
OpenEvent
</Button>
)}

{result.type==="sheet"&&result.url&&(
<Button
size="sm"
onClick={handleOpenExternal}
className="flex-1"
aria-label={`Openspreadsheet:${result.title}inGoogleSheets`}
>
<ExternalLinkclassName="size-4"aria-hidden="true"/>
OpenSheet
</Button>
)}

{result.type==="file"&&result.url&&(
<Button
size="sm"
onClick={handleDownload}
className="flex-1"
aria-label={`Downloadfile:${result.title}`}
>
<DownloadclassName="size-4"aria-hidden="true"/>
Download
</Button>
)}

{/*Copytoclipboardbutton*/}
<Button
size="sm"
variant="outline"
onClick={handleCopyToClipboard}
disabled={copied}
aria-label={copied?"Copiedtoclipboard":"Copytoclipboard"}
>
{copied?(
<>
<CheckclassName="size-4"aria-hidden="true"/>
Copied
</>
):(
<>
<CopyclassName="size-4"aria-hidden="true"/>
Copy
</>
)}
</Button>
</div>
);
}
