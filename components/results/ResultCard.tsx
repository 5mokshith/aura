"useclient";

importReactfrom"react";
importtype{WorkflowResult}from"@/types";
import{FileText,Mail,Calendar,Sheet,File}from"lucide-react";
import{ActionButtons}from"./ActionButtons";
import{FeedbackWidget}from"./FeedbackWidget";
import{cn}from"@/lib/utils";

interfaceResultCardProps{
result:WorkflowResult;
onFeedback:(resultId:string,rating:"positive"|"negative")=>void;
}

constresultTypeConfig={
document:{
icon:FileText,
label:"Document",
color:"text-blue-600dark:text-blue-400",
bgColor:"bg-blue-50dark:bg-blue-950/30",
},
email:{
icon:Mail,
label:"Email",
color:"text-green-600dark:text-green-400",
bgColor:"bg-green-50dark:bg-green-950/30",
},
calendar:{
icon:Calendar,
label:"CalendarEvent",
color:"text-purple-600dark:text-purple-400",
bgColor:"bg-purple-50dark:bg-purple-950/30",
},
sheet:{
icon:Sheet,
label:"Spreadsheet",
color:"text-emerald-600dark:text-emerald-400",
bgColor:"bg-emerald-50dark:bg-emerald-950/30",
},
file:{
icon:File,
label:"File",
color:"text-gray-600dark:text-gray-400",
bgColor:"bg-gray-50dark:bg-gray-950/30",
},
};

exportfunctionResultCard({result,onFeedback}:ResultCardProps){
constconfig=resultTypeConfig[result.type];
constIcon=config.icon;

//Truncatepreviewto500characters
constpreview=result.preview
?result.preview.length>500
?`${result.preview.substring(0,500)}...`
:result.preview
:null;

return(
<article
className="borderrounded-lgbg-cardoverflow-hiddenhover:shadow-mdtransition-shadow"
role="listitem"
aria-label={`${config.label}:${result.title}`}
>
{/*Headerwithiconandtype*/}
<divclassName={cn("px-4py-3flexitems-centergap-3",config.bgColor)}>
<divclassName={cn("rounded-mdp-2bg-whitedark:bg-gray-900",config.bgColor)}aria-hidden="true">
<IconclassName={cn("size-5",config.color)}/>
</div>
<divclassName="flex-1min-w-0">
<pclassName="text-xsfont-mediumtext-muted-foregrounduppercasetracking-wide">
{config.label}
</p>
<h3className="font-semiboldtext-smtruncate"title={result.title}>
{result.title}
</h3>
</div>
</div>

{/*Previewsection*/}
{preview&&(
<divclassName="px-4py-3border-tbg-muted/30">
<pclassName="text-smtext-muted-foregroundline-clamp-4whitespace-pre-wrap"aria-label="Contentpreview">
{preview}
</p>
</div>
)}

{/*Actionbuttons*/}
<divclassName="px-4py-3border-t">
<ActionButtonsresult={result}/>
</div>

{/*Feedbackwidget*/}
<divclassName="px-4py-3border-tbg-muted/20">
<FeedbackWidget
resultId={result.id}
onFeedback={onFeedback}
/>
</div>
</article>
);
}
